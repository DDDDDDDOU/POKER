{"remainingRequest":"/Users/user/Desktop/web2.0/WeIns_F/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/user/Desktop/web2.0/WeIns_F/src/components/comment.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/user/Desktop/web2.0/WeIns_F/src/components/comment.vue","mtime":1598592890398},{"path":"/Users/user/Desktop/web2.0/WeIns_F/node_modules/cache-loader/dist/cjs.js","mtime":1594082385499},{"path":"/Users/user/Desktop/web2.0/WeIns_F/node_modules/babel-loader/lib/index.js","mtime":1594082385506},{"path":"/Users/user/Desktop/web2.0/WeIns_F/node_modules/cache-loader/dist/cjs.js","mtime":1594082385499},{"path":"/Users/user/Desktop/web2.0/WeIns_F/node_modules/vue-loader/lib/index.js","mtime":1594082401315}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBheGlvcyBmcm9tICdheGlvcyc7CmltcG9ydCByZWxlYXNlIGZyb20gIi4vcmVsZWFzZV9jb21tZW50IjsKCmV4cG9ydCBkZWZhdWx0IHsKICAgIGNvbXBvbmVudHM6IHsKICAgICAgICByZWxlYXNlCiAgICB9LAogICAgcHJvcHM6IHsKICAgICAgICBiaWQ6IE51bWJlciwKICAgICAgICB0b191aWQ6IE51bWJlciwKICAgICAgICBkYXRhOiBPYmplY3QKICAgIH0sCiAgICBkYXRhKCkgewogICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIHJlcGxpZXM6IFtdLAogICAgICAgICAgICBzaXplOiAwLAogICAgICAgICAgICByZXBseV9mbGFnOiBmYWxzZSwKICAgICAgICAgICAgZGVsZXRlX2ZsYWc6IGZhbHNlLAogICAgICAgICAgICBzaG93X2ZsYWc6IDAKICAgICAgICB9CiAgICB9LAogICAgY3JlYXRlZCgpIHsKICAgICAgICB0aGlzLmRlbGV0ZV9mbGFnID0gKHRoaXMuJHJvb3QuYXV0aF9jb21tZW50X21hbmFnZXIgPT09IHRydWUgfHwgdGhpcy4kcHJvcHMuZGF0YS51aWQgPT09IE51bWJlcihzZXNzaW9uU3RvcmFnZS5nZXRJdGVtKCJpZCIpKSk7CgogICAgICAgIGxldCBjaWQgPSB0aGlzLiRwcm9wcy5kYXRhLmNpZDsKICAgICAgICBsZXQgdG1wID0gSlNPTi5wYXJzZShzZXNzaW9uU3RvcmFnZS5nZXRJdGVtKCJjb21tZW50cyIpKTsKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRtcC5sZW5ndGg7ICsraSkgewogICAgICAgICAgICBpZiAodG1wW2ldLnJvb3RfY2lkID09PSBjaWQpIHsKICAgICAgICAgICAgICAgIHRtcFtpXS5mbGFnID0gZmFsc2U7CiAgICAgICAgICAgICAgICB0bXBbaV0uZGVsZXRlX2ZsYWcgPSAodGhpcy4kcm9vdC5hdXRoX2NvbW1lbnRfbWFuYWdlciA9PT0gdHJ1ZSB8fCB0bXBbaV0udWlkID09PSBOdW1iZXIoc2Vzc2lvblN0b3JhZ2UuZ2V0SXRlbSgiaWQiKSkpOwogICAgICAgICAgICAgICAgdGhpcy5yZXBsaWVzLnB1c2godG1wW2ldKTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgdGhpcy5zaXplID0gdGhpcy5yZXBsaWVzLmxlbmd0aDsKICAgICAgICBpZiAodGhpcy5zaXplID4gNSkKICAgICAgICAgICAgdGhpcy5zaG93X2ZsYWcgPSAxOwogICAgfSwKCiAgICBtZXRob2RzOiB7CiAgICAgICAgZGlzcGxheVJlcGx5Q29udGVudChyZXBseSl7CiAgICAgICAgICAgIGlmIChyZXBseS50b19jaWQgIT09IHRoaXMuJHByb3BzLmRhdGEuY2lkKQogICAgICAgICAgICAgICAgcmV0dXJuICflm57lpI1AJyArIHJlcGx5LnRvX3VzZXJuYW1lICsgJzonICsgcmVwbHkuY29udGVudDsKICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgcmV0dXJuIHJlcGx5LmNvbnRlbnQ7CiAgICAgICAgfSwKICAgICAgICBmZWVkYmFjayh0eXBlKSB7CiAgICAgICAgICAgIGlmICh0eXBlID09PSAtMSkKICAgICAgICAgICAgICAgIHRoaXMucmVwbHlfZmxhZyA9ICh0aGlzLnJlcGx5X2ZsYWcgIT09IHRydWUpOwogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICB0aGlzLnJlcGxpZXNbdHlwZV0uZmxhZyA9ICh0aGlzLnJlcGxpZXNbdHlwZV0uZmxhZyAhPT0gdHJ1ZSk7CiAgICAgICAgfSwKICAgICAgICBsaWtlKCkgewogICAgICAgICAgICB0aGlzLiRtZXNzYWdlLmluZm8oJ+aaguS4jeaUr+aMgScpOwogICAgICAgIH0sCiAgICAgICAgcmVtb3ZlKGNpZCkgewogICAgICAgICAgICBsZXQgdXJsID0gJ2h0dHA6Ly9sb2NhbGhvc3Q6ODA4OC9ibG9nL3JlbW92ZUNvbW1lbnQ/dWlkPScgKyBzZXNzaW9uU3RvcmFnZS5nZXRJdGVtKCJpZCIpCiAgICAgICAgICAgICArICcmY2lkPScgKyBjaWQKICAgICAgICAgICAgICsgJyZ0eXBlPScgKyBzZXNzaW9uU3RvcmFnZS5nZXRJdGVtKCJ0eXBlIik7CgogICAgICAgICAgICBheGlvcy5wb3N0KHVybCwgewogICAgICAgICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICAgICAgICAgIHRva2VuOiBzZXNzaW9uU3RvcmFnZS5nZXRJdGVtKCJ0b2tlbiIpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pLnRoZW4ocmVzID0+IHsKICAgICAgICAgICAgICAgIGlmIChyZXMuZGF0YSA9PT0gdHJ1ZSkgewogICAgICAgICAgICAgICAgICAgIHRoaXMuJG1lc3NhZ2Uuc3VjY2Vzcygn5Yig6Zmk6K+E6K665oiQ5Yqf77yBJyk7CiAgICAgICAgICAgICAgICAgICAgdGhpcy4kZW1pdCgnY2hhbmdlJyk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcign5rKh5pyJ5p2D6ZmQ5Yig6Zmk77yBJyk7CiAgICAgICAgICAgIH0pLmNhdGNoKGVyciA9PnsKICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycik7CiAgICAgICAgICAgIH0pOwogICAgICAgIH0sCiAgICAgICAgc2hvd01vcmUoKSB7CiAgICAgICAgICAgIGlmICh0aGlzLnNob3dfZmxhZyA9PT0gMSkKICAgICAgICAgICAgICAgIHRoaXMuc2hvd19mbGFnID0gMjsKICAgICAgICAgICAgZWxzZSBpZiAodGhpcy5zaG93X2ZsYWcgPT09IDIpCiAgICAgICAgICAgICAgICB0aGlzLnNob3dfZmxhZyA9IDE7CiAgICAgICAgfSwKICAgICAgICB2aXNpdCh1aWQpIHsKICAgICAgICAgICAgdGhpcy4kcm91dGVyLnB1c2goewogICAgICAgICAgICAgICAgcGF0aDogJy92aXNpdCcsCiAgICAgICAgICAgICAgICBxdWVyeTogewogICAgICAgICAgICAgICAgICAgIGlkOiB1aWQKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSkKICAgICAgICB9CiAgICB9Cn0K"},{"version":3,"sources":["comment.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+FA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"comment.vue","sourceRoot":"src/components","sourcesContent":["<template>\n    <el-card class=\"com\" shadow=\"hover\">\n\n        <div class=\"avatar\">\n            <el-avatar class=\"comava\" shape=\"square\" :size=\"50\" :src=\"data.avatar\"></el-avatar>\n        </div>\n\n        <div>\n            <div class=\"content\">\n\n                <div class=\"con\">\n                    <p class=\"content-text1\">{{data.username}}</p>\n                    <p class=\"content-text2\"> : {{data.content}}</p>\n                </div>\n\n                <div class=\"icons\">\n                    <el-row>\n                        <el-col class=\"icon1\" :span=\"6\">\n                            <p>{{data.post_time}}</p>\n                        </el-col>\n\n                        <el-col class=\"icon2\" :span=\"6\">\n                            <el-button type=\"text\" icon=\"el-icon-chat-dot-square\" @click=\"feedback(-1)\">回复</el-button>\n                        </el-col>\n                        <el-col class=\"icon2\" :span=\"6\">\n                            <el-button type=\"text\" icon=\"el-icon-star-off\" @click=\"like\">喜欢</el-button>\n                        </el-col>\n                        <el-col class=\"icon2\" :span=\"6\">\n                            <div v-if=\"delete_flag === true\">\n                                <el-button type=\"text\" icon=\"el-icon-delete\" @click=\"remove(data.cid)\">删除</el-button>\n                            </div>\n\n                            <div v-else>\n                                <p style=\"color: #f2f2f5\">占位置</p>\n                            </div>\n                        </el-col>\n                    </el-row>\n                </div>\n\n                <release v-if=\"reply_flag === true\" :type=\"1\" :bid=\"data.bid\" :to_uid=\"data.uid\" :to_username=\"data.username\" :comment=\"data\"></release>\n\n                <div class=\"re-comment\">\n                    <div class=\"con2\" v-if=\"show_flag === 0 || show_flag === 2\">\n                        <ul><li style=\"clear: both\" v-for=\"(reply, index) in replies\" :key=\"reply.cid\">\n                            <div class=\"reply\">\n                                <div class=\"content-text4\" style=\"margin-left: 5px; margin-top: 5px\">\n                                    <el-button type=\"text\" size=\"mini\" style=\"font-size: 14px; margin-top: -6px; z-index: 999\" @click=\"visit(reply.uid)\">{{reply.username}}</el-button> : {{displayReplyContent(reply)}}\n                                </div>\n\n                                <div style=\"margin-left: 5px\">\n                                    <el-row>\n                                        <el-col :span=\"18\">\n                                            <p class=\"content-text5\">{{reply.post_time}}</p>\n                                        </el-col>\n                                        <el-col :span=\"3\">\n                                            <div v-if=\"reply.delete_flag === true\">\n                                                <el-button icon=\"el-icon-delete\" type=\"text\" @click=\"remove(reply.cid)\" style=\"z-index: 999\">删除</el-button>\n                                                <el-divider direction=\"vertical\"></el-divider>\n                                            </div>\n                                            <div v-else>\n                                                <p style=\"color: #eaeaec\">占位置</p>\n                                            </div>\n                                        </el-col>\n                                        <el-col :span=\"3\">\n                                            <el-button icon=\"el-icon-chat-dot-square\" type=\"text\" @click=\"feedback(index)\" style=\"z-index: 999\">回复</el-button>\n                                        </el-col>\n                                    </el-row>\n                                </div>\n\n                                <release v-if=\"reply.flag === true\" :type=\"1\" :bid=\"reply.bid\" :to_uid=\"reply.uid\" :to_username=\"reply.username\" :comment=\"reply\"></release>\n                            </div>\n                        </li></ul>\n                    </div>\n\n                    <div class=\"more-button\">\n                        <el-row>\n                            <el-col :span=\"12\">\n                                <div v-if=\"show_flag === 1\">\n                                    <el-button type=\"text\" @click=\"showMore\" style=\"z-index: 999\">共{{size}}条回复，查看更多 >></el-button>\n                                </div>\n                            </el-col>\n                            <el-col :span=\"12\">\n                                <div v-if=\"show_flag === 2\">\n                                    <el-button type=\"text\" @click=\"showMore\"> >> 收起</el-button>\n                                </div>\n                            </el-col>\n                        </el-row>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </el-card>\n</template>\n\n<script>\n    import axios from 'axios';\n    import release from \"./release_comment\";\n\n    export default {\n        components: {\n            release\n        },\n        props: {\n            bid: Number,\n            to_uid: Number,\n            data: Object\n        },\n        data() {\n            return {\n                replies: [],\n                size: 0,\n                reply_flag: false,\n                delete_flag: false,\n                show_flag: 0\n            }\n        },\n        created() {\n            this.delete_flag = (this.$root.auth_comment_manager === true || this.$props.data.uid === Number(sessionStorage.getItem(\"id\")));\n\n            let cid = this.$props.data.cid;\n            let tmp = JSON.parse(sessionStorage.getItem(\"comments\"));\n            for (let i = 0; i < tmp.length; ++i) {\n                if (tmp[i].root_cid === cid) {\n                    tmp[i].flag = false;\n                    tmp[i].delete_flag = (this.$root.auth_comment_manager === true || tmp[i].uid === Number(sessionStorage.getItem(\"id\")));\n                    this.replies.push(tmp[i]);\n                }\n            }\n\n            this.size = this.replies.length;\n            if (this.size > 5)\n                this.show_flag = 1;\n        },\n\n        methods: {\n            displayReplyContent(reply){\n                if (reply.to_cid !== this.$props.data.cid)\n                    return '回复@' + reply.to_username + ':' + reply.content;\n                else\n                    return reply.content;\n            },\n            feedback(type) {\n                if (type === -1)\n                    this.reply_flag = (this.reply_flag !== true);\n                else\n                    this.replies[type].flag = (this.replies[type].flag !== true);\n            },\n            like() {\n                this.$message.info('暂不支持');\n            },\n            remove(cid) {\n                let url = 'http://localhost:8088/blog/removeComment?uid=' + sessionStorage.getItem(\"id\")\n                 + '&cid=' + cid\n                 + '&type=' + sessionStorage.getItem(\"type\");\n\n                axios.post(url, {\n                    headers: {\n                        token: sessionStorage.getItem(\"token\")\n                    }\n                }).then(res => {\n                    if (res.data === true) {\n                        this.$message.success('删除评论成功！');\n                        this.$emit('change');\n                    }\n                    else\n                        this.$message.error('没有权限删除！');\n                }).catch(err =>{\n                    console.log(err);\n                });\n            },\n            showMore() {\n                if (this.show_flag === 1)\n                    this.show_flag = 2;\n                else if (this.show_flag === 2)\n                    this.show_flag = 1;\n            },\n            visit(uid) {\n                this.$router.push({\n                    path: '/visit',\n                    query: {\n                        id: uid\n                    }\n                })\n            }\n        }\n    }\n</script>\n\n<style scoped>\n    .avatar {\n        float: left;\n        width: 8%;\n    }\n\n    .content {\n        width: 80%;\n        float: left;\n        margin-left: 5%;\n        color: black;\n    }\n\n    .down {\n        float: right;\n        width: 10%;\n    }\n\n    .comava {\n        float: left;\n        margin-left: 3%;\n        margin-bottom: 10%;\n    }\n\n    .con {\n        clear: both;\n    }\n\n    .con2 {\n        margin-bottom: 5%;\n     }\n\n    .icons {\n        clear: both;\n    }\n\n    .content-text1 {\n        text-align: left;\n        float: left;\n        color: dodgerblue;\n    }\n\n    .content-text2 {\n        text-align: left;\n        float: left;\n    }\n\n    .icon1 {\n        text-align: left;\n        float: left;\n        margin-top:1.5%;\n        color: darkgray;\n        font-size: 12px;\n    }\n\n    .icon2 {\n        float: right;\n        text-align: right;\n    }\n\n    .re-comment {\n        clear: both;\n        width: 100%;\n    }\n\n    .reply {\n        background-color: #eaeaec;\n        width: 100%;\n    }\n\n    .content-text4 {\n        width: 100%;\n        word-break:break-all;\n        float: left;\n        display: flex;\n    }\n\n    .more-button {\n        width: 100%;\n    }\n\n    .com {\n        background-color: #f2f2f5;\n    }\n\n    .content-text5 {\n        float: left;\n        margin-top: 13px;\n        color: darkgray;\n        font-size: 10px;\n    }\n</style>\n"]}]}