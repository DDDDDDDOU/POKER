{"remainingRequest":"/Users/user/Desktop/web2.0/WeIns_F/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/user/Desktop/web2.0/WeIns_F/src/components/personalcard.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/user/Desktop/web2.0/WeIns_F/src/components/personalcard.vue","mtime":1599316367489},{"path":"/Users/user/Desktop/web2.0/WeIns_F/node_modules/cache-loader/dist/cjs.js","mtime":1594082385499},{"path":"/Users/user/Desktop/web2.0/WeIns_F/node_modules/babel-loader/lib/index.js","mtime":1594082385506},{"path":"/Users/user/Desktop/web2.0/WeIns_F/node_modules/cache-loader/dist/cjs.js","mtime":1594082385499},{"path":"/Users/user/Desktop/web2.0/WeIns_F/node_modules/vue-loader/lib/index.js","mtime":1594082401315}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBheGlvcyBmcm9tICJheGlvcyI7CgpleHBvcnQgZGVmYXVsdCB7CiAgICBkYXRhKCkgewogICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIHVwZGF0ZV9mbGFnOiBmYWxzZSwKICAgICAgICAgICAgb3JpZ2luX2F2YXRhcjogJycsCiAgICAgICAgICAgIHVzZXI6IHsKICAgICAgICAgICAgICAgIGlkOiAwLAogICAgICAgICAgICAgICAgbmFtZTogJ+S6pOmAmuWkp+WtpicsCiAgICAgICAgICAgICAgICBiaXJ0aGRheTogJzE4OTYtMDQtMDcnLAogICAgICAgICAgICAgICAgc2V4OiAtMSwKICAgICAgICAgICAgICAgIHJlZ190aW1lOiAnMjAyMC0wNy0wMScsCiAgICAgICAgICAgICAgICBwaG9uZTogJzAyMTEzNDIwMDAwMCcsCiAgICAgICAgICAgICAgICB1c2VyTW9uZ286IHsKICAgICAgICAgICAgICAgICAgICBhdmF0YXI6ICcnCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9LAogICAgY3JlYXRlZCgpIHsKICAgICAgICB0aGlzLmdlbmVyYXRvcigpOwogICAgfSwKICAgIG1ldGhvZHM6IHsKICAgICAgICBnZW5lcmF0b3IoKSB7CiAgICAgICAgICAgIHRoaXMudXNlci5pZCA9IHNlc3Npb25TdG9yYWdlLmdldEl0ZW0oImlkIik7CiAgICAgICAgICAgIGlmKHRoaXMudXNlci5pZD09bnVsbCkgdGhpcy51c2VyLmlkPScxMjMnOwogICAgICAgICAgICBsZXQgdXJsID0gJ2h0dHA6Ly9sb2NhbGhvc3Q6ODA4OC91c2VyL2dldFBsYWluT25lP2lkPScgKyB0aGlzLnVzZXIuaWQ7CgogICAgICAgICAgICAvLyBheGlvcy5nZXQodXJsLCB7CiAgICAgICAgICAgIC8vICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgIC8vICAgICAgICAgdG9rZW46IHNlc3Npb25TdG9yYWdlLmdldEl0ZW0oInRva2VuIikKICAgICAgICAgICAgLy8gICAgIH0KICAgICAgICAgICAgLy8gfSkudGhlbihyZXMgPT4gewogICAgICAgICAgICAvLyAgICAgdGhpcy51c2VyID0gcmVzLmRhdGE7CiAgICAgICAgICAgIC8vICAgICB0aGlzLm9yaWdpbl9hdmF0YXIgPSB0aGlzLnVzZXIudXNlck1vbmdvLmF2YXRhcjsKICAgICAgICAgICAgLy8gfSkuY2F0Y2goZXJyID0+IHsKICAgICAgICAgICAgLy8gICAgIGNvbnNvbGUubG9nKGVycik7CiAgICAgICAgICAgIC8vIH0pOwogICAgICAgICAgICByZXR1cm4gdGhpcy5heGlvcy5wb3N0KHVybCkudGhlbihyZXM9PnsKICAgICAgICAgICAgICAgIHJldHVybiByZXMgPT09ICdzdWNjZXNzJzsKICAgICAgICAgICAgfSk7CiAgICAgICAgfSwKICAgICAgICBnZXRCYXNlNjQoZmlsZSkgewogICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewogICAgICAgICAgICAgICAgbGV0IHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKCk7CiAgICAgICAgICAgICAgICBsZXQgaW1nUmVzdWx0ID0gJyc7CiAgICAgICAgICAgICAgICByZWFkZXIucmVhZEFzRGF0YVVSTChmaWxlKTsKICAgICAgICAgICAgICAgIHJlYWRlci5vbmxvYWQgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgaW1nUmVzdWx0ID0gcmVhZGVyLnJlc3VsdDsKICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICByZWFkZXIub25lcnJvciA9IGZ1bmN0aW9uIChlcnJvcikgewogICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnJvcik7CiAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgcmVhZGVyLm9ubG9hZGVuZCA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICByZXNvbHZlKGltZ1Jlc3VsdCk7CiAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICB9KTsKICAgICAgICB9LAogICAgICAgIGdldEZpbGUoZmlsZSkgewoKICAgICAgICAgICAgdGhpcy5nZXRCYXNlNjQoZmlsZS5yYXcpLnRoZW4ocmVzID0+IHsKICAgICAgICAgICAgICAgIHRoaXMudXNlci51c2VyTW9uZ28uYXZhdGFyID0gcmVzOwogICAgICAgICAgICB9KTsKCiAgICAgICAgICAgIHRoaXMudXBkYXRlX2ZsYWcgPSB0cnVlOwogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9LAogICAgICAgIGNhbmNlbCgpIHsKICAgICAgICAgICAgdGhpcy51cGRhdGVfZmxhZyA9IGZhbHNlOwogICAgICAgICAgICB0aGlzLnVzZXIudXNlck1vbmdvLmF2YXRhciA9IHRoaXMub3JpZ2luX2F2YXRhcjsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfSwKICAgICAgICB1cGxvYWQoKSB7CiAgICAgICAgICAgIGxldCB1cmwgPSAnaHR0cDovL2xvY2FsaG9zdDo4MDg4L3VzZXIvdXBkYXRlJzsKICAgICAgICAgICAgY29uc29sZS5sb2codXJsKTsKCiAgICAgICAgICAgIGxldCBmb3JtID0gdGhpcy51c2VyOwogICAgICAgICAgICBmb3JtLmF2YXRhciA9IHRoaXMudXNlci51c2VyTW9uZ28uYXZhdGFyOwoKICAgICAgICAgICAgLy8gYXhpb3MucG9zdCh1cmwsIGZvcm0sIHsKICAgICAgICAgICAgLy8gICAgIGhlYWRlcnM6IHsKICAgICAgICAgICAgLy8gICAgICAgICB0b2tlbjogc2Vzc2lvblN0b3JhZ2UuZ2V0SXRlbSgidG9rZW4iKQogICAgICAgICAgICAvLyAgICAgfQogICAgICAgICAgICAvLyB9KS50aGVuKHJlcyA9PiB7CiAgICAgICAgICAgIC8vICAgICBpZihyZXMuZGF0YSA9PT0gJ3N1Y2Nlc3MnKQogICAgICAgICAgICAvLyAgICAgICAgIHRoaXMuJG1lc3NhZ2Uuc3VjY2Vzcygn5pu05o2i5aS05YOP5oiQ5Yqf77yBJyk7CiAgICAgICAgICAgIC8vICAgICBjb25zb2xlLmxvZyhyZXMuZGF0YSk7CiAgICAgICAgICAgIC8vIH0pLmNhdGNoKGVyciA9PiB7CiAgICAgICAgICAgIC8vICAgIGNvbnNvbGUubG9nKGVycik7CiAgICAgICAgICAgIC8vIH0pOwoKICAgICAgICAgICAgdGhpcy51cGRhdGVfZmxhZyA9IGZhbHNlOwogICAgICAgICAgICByZXR1cm4gdGhpcy5heGlvcy5wb3N0KHVybCkudGhlbihyZXM9PnsKICAgICAgICAgICAgICAgIHJldHVybiByZXMgPT09ICdzdWNjZXNzJzsKICAgICAgICAgICAgfSk7CiAgICAgICAgfQogICAgfQp9Cg=="},{"version":3,"sources":["personalcard.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAoCA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA","file":"personalcard.vue","sourceRoot":"src/components","sourcesContent":["<template>\n    <div class=\"extern\">\n        <el-card style=\"width: 90%; text-align: center; margin-left: 5%\">\n                <div class=\"back\">\n                    <img class=\"pic\" v-bind:src=\"user.userMongo.avatar\" alt=\"picture\"/>\n                    <div class=\"text1\">\n                        {{user.name}}\n                    </div>\n                    <div class=\"text2\" v-if=\"this.update_flag === false\">\n                        <el-upload\n                                action='string'\n                                style=\"width: 80%;z-index: 998\"\n                                class=\"avatar-uploader\"\n                                :on-change=\"getFile\"\n                                :limit=\"1\"\n                                :auto-upload=\"false\"\n                                :show-file-list=\"false\"\n                                accept=\".jpg,.jpeg,.png\">\n                            <el-button size=\"mini\" type=\"plain\" icon=\"el-icon-upload\">上传头像</el-button>\n                        </el-upload>\n                    </div>\n\n                    <div v-if=\"this.update_flag === true\" class=\"text3\">\n                        <el-button size=\"mini\" type=\"primary\" icon=\"el-icon-check\" @click=\"upload\"></el-button>\n                        <el-button size=\"mini\" type=\"danger\" icon=\"el-icon-close\" @click=\"cancel\"></el-button>\n                    </div>\n                </div>\n                <el-menu class=\"el-menu-demo\" mode=\"horizontal\" default-active=\"1\">\n                    <el-menu-item class=\"menu\" index=\"1\">我的主页</el-menu-item>\n                    <el-menu-item class=\"menu\" index=\"2\">管理中心</el-menu-item>\n                </el-menu>\n        </el-card>\n    </div>\n</template>\n\n<script>\n    import axios from \"axios\";\n\n    export default {\n        data() {\n            return {\n                update_flag: false,\n                origin_avatar: '',\n                user: {\n                    id: 0,\n                    name: '交通大学',\n                    birthday: '1896-04-07',\n                    sex: -1,\n                    reg_time: '2020-07-01',\n                    phone: '021134200000',\n                    userMongo: {\n                        avatar: ''\n                    }\n                }\n            }\n        },\n        created() {\n            this.generator();\n        },\n        methods: {\n            generator() {\n                this.user.id = sessionStorage.getItem(\"id\");\n                if(this.user.id==null) this.user.id='123';\n                let url = 'http://localhost:8088/user/getPlainOne?id=' + this.user.id;\n\n                // axios.get(url, {\n                //     headers: {\n                //         token: sessionStorage.getItem(\"token\")\n                //     }\n                // }).then(res => {\n                //     this.user = res.data;\n                //     this.origin_avatar = this.user.userMongo.avatar;\n                // }).catch(err => {\n                //     console.log(err);\n                // });\n                return this.axios.post(url).then(res=>{\n                    return res === 'success';\n                });\n            },\n            getBase64(file) {\n                return new Promise(function (resolve, reject) {\n                    let reader = new FileReader();\n                    let imgResult = '';\n                    reader.readAsDataURL(file);\n                    reader.onload = function () {\n                        imgResult = reader.result;\n                    };\n                    reader.onerror = function (error) {\n                        reject(error);\n                    };\n                    reader.onloadend = function () {\n                        resolve(imgResult);\n                    };\n                });\n            },\n            getFile(file) {\n\n                this.getBase64(file.raw).then(res => {\n                    this.user.userMongo.avatar = res;\n                });\n\n                this.update_flag = true;\n                return true;\n            },\n            cancel() {\n                this.update_flag = false;\n                this.user.userMongo.avatar = this.origin_avatar;\n                return true;\n            },\n            upload() {\n                let url = 'http://localhost:8088/user/update';\n                console.log(url);\n\n                let form = this.user;\n                form.avatar = this.user.userMongo.avatar;\n\n                // axios.post(url, form, {\n                //     headers: {\n                //         token: sessionStorage.getItem(\"token\")\n                //     }\n                // }).then(res => {\n                //     if(res.data === 'success')\n                //         this.$message.success('更换头像成功！');\n                //     console.log(res.data);\n                // }).catch(err => {\n                //    console.log(err);\n                // });\n\n                this.update_flag = false;\n                return this.axios.post(url).then(res=>{\n                    return res === 'success';\n                });\n            }\n        }\n    }\n</script>\n\n<style scoped>\n    .extern {\n        width: 100%;\n        flex-direction: column;\n    }\n\n    .back {\n        width: 100%;\n        height: 300px;\n        background: url(\"../assets/image/poster_1.png\");\n    }\n\n    .pic {\n        margin-top: 40px;\n        width: 150px;\n        height:150px;\n        border-radius: 75px;\n        clear: both;\n    }\n\n    .text1 {\n        text-align: center;\n        clear: both;\n        color: white;\n        font-size: xx-large;\n    }\n\n    .text2 {\n        clear: both;\n        text-align: center;\n        color: #c6c6c6;\n        margin-top: 20px;\n        margin-left: 130px;\n    }\n\n    .text3 {\n        clear: both;\n        text-align: center;\n        color: #c6c6c6;\n        margin-top: 20px;\n    }\n\n    .menu {\n        width: 50%;\n    }\n\n</style>\n"]}]}