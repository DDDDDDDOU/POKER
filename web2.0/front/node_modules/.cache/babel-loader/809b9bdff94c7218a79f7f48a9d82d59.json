{"remainingRequest":"/Users/user/Desktop/web2.0/WeIns_F/node_modules/babel-loader/lib/index.js!/Users/user/Desktop/web2.0/WeIns_F/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/user/Desktop/web2.0/WeIns_F/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/user/Desktop/web2.0/WeIns_F/src/components/comment.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/user/Desktop/web2.0/WeIns_F/src/components/comment.vue","mtime":1598592890398},{"path":"/Users/user/Desktop/web2.0/WeIns_F/node_modules/cache-loader/dist/cjs.js","mtime":1594082385499},{"path":"/Users/user/Desktop/web2.0/WeIns_F/node_modules/babel-loader/lib/index.js","mtime":1594082385506},{"path":"/Users/user/Desktop/web2.0/WeIns_F/node_modules/cache-loader/dist/cjs.js","mtime":1594082385499},{"path":"/Users/user/Desktop/web2.0/WeIns_F/node_modules/vue-loader/lib/index.js","mtime":1594082401315}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMubnVtYmVyLmNvbnN0cnVjdG9yIjsKLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KaW1wb3J0IGF4aW9zIGZyb20gJ2F4aW9zJzsKaW1wb3J0IHJlbGVhc2UgZnJvbSAiLi9yZWxlYXNlX2NvbW1lbnQiOwpleHBvcnQgZGVmYXVsdCB7CiAgY29tcG9uZW50czogewogICAgcmVsZWFzZTogcmVsZWFzZQogIH0sCiAgcHJvcHM6IHsKICAgIGJpZDogTnVtYmVyLAogICAgdG9fdWlkOiBOdW1iZXIsCiAgICBkYXRhOiBPYmplY3QKICB9LAogIGRhdGE6IGZ1bmN0aW9uIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICByZXBsaWVzOiBbXSwKICAgICAgc2l6ZTogMCwKICAgICAgcmVwbHlfZmxhZzogZmFsc2UsCiAgICAgIGRlbGV0ZV9mbGFnOiBmYWxzZSwKICAgICAgc2hvd19mbGFnOiAwCiAgICB9OwogIH0sCiAgY3JlYXRlZDogZnVuY3Rpb24gY3JlYXRlZCgpIHsKICAgIHRoaXMuZGVsZXRlX2ZsYWcgPSB0aGlzLiRyb290LmF1dGhfY29tbWVudF9tYW5hZ2VyID09PSB0cnVlIHx8IHRoaXMuJHByb3BzLmRhdGEudWlkID09PSBOdW1iZXIoc2Vzc2lvblN0b3JhZ2UuZ2V0SXRlbSgiaWQiKSk7CiAgICB2YXIgY2lkID0gdGhpcy4kcHJvcHMuZGF0YS5jaWQ7CiAgICB2YXIgdG1wID0gSlNPTi5wYXJzZShzZXNzaW9uU3RvcmFnZS5nZXRJdGVtKCJjb21tZW50cyIpKTsKCiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRtcC5sZW5ndGg7ICsraSkgewogICAgICBpZiAodG1wW2ldLnJvb3RfY2lkID09PSBjaWQpIHsKICAgICAgICB0bXBbaV0uZmxhZyA9IGZhbHNlOwogICAgICAgIHRtcFtpXS5kZWxldGVfZmxhZyA9IHRoaXMuJHJvb3QuYXV0aF9jb21tZW50X21hbmFnZXIgPT09IHRydWUgfHwgdG1wW2ldLnVpZCA9PT0gTnVtYmVyKHNlc3Npb25TdG9yYWdlLmdldEl0ZW0oImlkIikpOwogICAgICAgIHRoaXMucmVwbGllcy5wdXNoKHRtcFtpXSk7CiAgICAgIH0KICAgIH0KCiAgICB0aGlzLnNpemUgPSB0aGlzLnJlcGxpZXMubGVuZ3RoOwogICAgaWYgKHRoaXMuc2l6ZSA+IDUpIHRoaXMuc2hvd19mbGFnID0gMTsKICB9LAogIG1ldGhvZHM6IHsKICAgIGRpc3BsYXlSZXBseUNvbnRlbnQ6IGZ1bmN0aW9uIGRpc3BsYXlSZXBseUNvbnRlbnQocmVwbHkpIHsKICAgICAgaWYgKHJlcGx5LnRvX2NpZCAhPT0gdGhpcy4kcHJvcHMuZGF0YS5jaWQpIHJldHVybiAn5Zue5aSNQCcgKyByZXBseS50b191c2VybmFtZSArICc6JyArIHJlcGx5LmNvbnRlbnQ7ZWxzZSByZXR1cm4gcmVwbHkuY29udGVudDsKICAgIH0sCiAgICBmZWVkYmFjazogZnVuY3Rpb24gZmVlZGJhY2sodHlwZSkgewogICAgICBpZiAodHlwZSA9PT0gLTEpIHRoaXMucmVwbHlfZmxhZyA9IHRoaXMucmVwbHlfZmxhZyAhPT0gdHJ1ZTtlbHNlIHRoaXMucmVwbGllc1t0eXBlXS5mbGFnID0gdGhpcy5yZXBsaWVzW3R5cGVdLmZsYWcgIT09IHRydWU7CiAgICB9LAogICAgbGlrZTogZnVuY3Rpb24gbGlrZSgpIHsKICAgICAgdGhpcy4kbWVzc2FnZS5pbmZvKCfmmoLkuI3mlK/mjIEnKTsKICAgIH0sCiAgICByZW1vdmU6IGZ1bmN0aW9uIHJlbW92ZShjaWQpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIHZhciB1cmwgPSAnaHR0cDovL2xvY2FsaG9zdDo4MDg4L2Jsb2cvcmVtb3ZlQ29tbWVudD91aWQ9JyArIHNlc3Npb25TdG9yYWdlLmdldEl0ZW0oImlkIikgKyAnJmNpZD0nICsgY2lkICsgJyZ0eXBlPScgKyBzZXNzaW9uU3RvcmFnZS5nZXRJdGVtKCJ0eXBlIik7CiAgICAgIGF4aW9zLnBvc3QodXJsLCB7CiAgICAgICAgaGVhZGVyczogewogICAgICAgICAgdG9rZW46IHNlc3Npb25TdG9yYWdlLmdldEl0ZW0oInRva2VuIikKICAgICAgICB9CiAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlcykgewogICAgICAgIGlmIChyZXMuZGF0YSA9PT0gdHJ1ZSkgewogICAgICAgICAgX3RoaXMuJG1lc3NhZ2Uuc3VjY2Vzcygn5Yig6Zmk6K+E6K665oiQ5Yqf77yBJyk7CgogICAgICAgICAgX3RoaXMuJGVtaXQoJ2NoYW5nZScpOwogICAgICAgIH0gZWxzZSBfdGhpcy4kbWVzc2FnZS5lcnJvcign5rKh5pyJ5p2D6ZmQ5Yig6Zmk77yBJyk7CiAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnIpIHsKICAgICAgICBjb25zb2xlLmxvZyhlcnIpOwogICAgICB9KTsKICAgIH0sCiAgICBzaG93TW9yZTogZnVuY3Rpb24gc2hvd01vcmUoKSB7CiAgICAgIGlmICh0aGlzLnNob3dfZmxhZyA9PT0gMSkgdGhpcy5zaG93X2ZsYWcgPSAyO2Vsc2UgaWYgKHRoaXMuc2hvd19mbGFnID09PSAyKSB0aGlzLnNob3dfZmxhZyA9IDE7CiAgICB9LAogICAgdmlzaXQ6IGZ1bmN0aW9uIHZpc2l0KHVpZCkgewogICAgICB0aGlzLiRyb3V0ZXIucHVzaCh7CiAgICAgICAgcGF0aDogJy92aXNpdCcsCiAgICAgICAgcXVlcnk6IHsKICAgICAgICAgIGlkOiB1aWQKICAgICAgICB9CiAgICAgIH0pOwogICAgfQogIH0KfTs="},{"version":3,"sources":["comment.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n    <el-card class=\"com\" shadow=\"hover\">\n\n        <div class=\"avatar\">\n            <el-avatar class=\"comava\" shape=\"square\" :size=\"50\" :src=\"data.avatar\"></el-avatar>\n        </div>\n\n        <div>\n            <div class=\"content\">\n\n                <div class=\"con\">\n                    <p class=\"content-text1\">{{data.username}}</p>\n                    <p class=\"content-text2\"> : {{data.content}}</p>\n                </div>\n\n                <div class=\"icons\">\n                    <el-row>\n                        <el-col class=\"icon1\" :span=\"6\">\n                            <p>{{data.post_time}}</p>\n                        </el-col>\n\n                        <el-col class=\"icon2\" :span=\"6\">\n                            <el-button type=\"text\" icon=\"el-icon-chat-dot-square\" @click=\"feedback(-1)\">回复</el-button>\n                        </el-col>\n                        <el-col class=\"icon2\" :span=\"6\">\n                            <el-button type=\"text\" icon=\"el-icon-star-off\" @click=\"like\">喜欢</el-button>\n                        </el-col>\n                        <el-col class=\"icon2\" :span=\"6\">\n                            <div v-if=\"delete_flag === true\">\n                                <el-button type=\"text\" icon=\"el-icon-delete\" @click=\"remove(data.cid)\">删除</el-button>\n                            </div>\n\n                            <div v-else>\n                                <p style=\"color: #f2f2f5\">占位置</p>\n                            </div>\n                        </el-col>\n                    </el-row>\n                </div>\n\n                <release v-if=\"reply_flag === true\" :type=\"1\" :bid=\"data.bid\" :to_uid=\"data.uid\" :to_username=\"data.username\" :comment=\"data\"></release>\n\n                <div class=\"re-comment\">\n                    <div class=\"con2\" v-if=\"show_flag === 0 || show_flag === 2\">\n                        <ul><li style=\"clear: both\" v-for=\"(reply, index) in replies\" :key=\"reply.cid\">\n                            <div class=\"reply\">\n                                <div class=\"content-text4\" style=\"margin-left: 5px; margin-top: 5px\">\n                                    <el-button type=\"text\" size=\"mini\" style=\"font-size: 14px; margin-top: -6px; z-index: 999\" @click=\"visit(reply.uid)\">{{reply.username}}</el-button> : {{displayReplyContent(reply)}}\n                                </div>\n\n                                <div style=\"margin-left: 5px\">\n                                    <el-row>\n                                        <el-col :span=\"18\">\n                                            <p class=\"content-text5\">{{reply.post_time}}</p>\n                                        </el-col>\n                                        <el-col :span=\"3\">\n                                            <div v-if=\"reply.delete_flag === true\">\n                                                <el-button icon=\"el-icon-delete\" type=\"text\" @click=\"remove(reply.cid)\" style=\"z-index: 999\">删除</el-button>\n                                                <el-divider direction=\"vertical\"></el-divider>\n                                            </div>\n                                            <div v-else>\n                                                <p style=\"color: #eaeaec\">占位置</p>\n                                            </div>\n                                        </el-col>\n                                        <el-col :span=\"3\">\n                                            <el-button icon=\"el-icon-chat-dot-square\" type=\"text\" @click=\"feedback(index)\" style=\"z-index: 999\">回复</el-button>\n                                        </el-col>\n                                    </el-row>\n                                </div>\n\n                                <release v-if=\"reply.flag === true\" :type=\"1\" :bid=\"reply.bid\" :to_uid=\"reply.uid\" :to_username=\"reply.username\" :comment=\"reply\"></release>\n                            </div>\n                        </li></ul>\n                    </div>\n\n                    <div class=\"more-button\">\n                        <el-row>\n                            <el-col :span=\"12\">\n                                <div v-if=\"show_flag === 1\">\n                                    <el-button type=\"text\" @click=\"showMore\" style=\"z-index: 999\">共{{size}}条回复，查看更多 >></el-button>\n                                </div>\n                            </el-col>\n                            <el-col :span=\"12\">\n                                <div v-if=\"show_flag === 2\">\n                                    <el-button type=\"text\" @click=\"showMore\"> >> 收起</el-button>\n                                </div>\n                            </el-col>\n                        </el-row>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </el-card>\n</template>\n\n<script>\n    import axios from 'axios';\n    import release from \"./release_comment\";\n\n    export default {\n        components: {\n            release\n        },\n        props: {\n            bid: Number,\n            to_uid: Number,\n            data: Object\n        },\n        data() {\n            return {\n                replies: [],\n                size: 0,\n                reply_flag: false,\n                delete_flag: false,\n                show_flag: 0\n            }\n        },\n        created() {\n            this.delete_flag = (this.$root.auth_comment_manager === true || this.$props.data.uid === Number(sessionStorage.getItem(\"id\")));\n\n            let cid = this.$props.data.cid;\n            let tmp = JSON.parse(sessionStorage.getItem(\"comments\"));\n            for (let i = 0; i < tmp.length; ++i) {\n                if (tmp[i].root_cid === cid) {\n                    tmp[i].flag = false;\n                    tmp[i].delete_flag = (this.$root.auth_comment_manager === true || tmp[i].uid === Number(sessionStorage.getItem(\"id\")));\n                    this.replies.push(tmp[i]);\n                }\n            }\n\n            this.size = this.replies.length;\n            if (this.size > 5)\n                this.show_flag = 1;\n        },\n\n        methods: {\n            displayReplyContent(reply){\n                if (reply.to_cid !== this.$props.data.cid)\n                    return '回复@' + reply.to_username + ':' + reply.content;\n                else\n                    return reply.content;\n            },\n            feedback(type) {\n                if (type === -1)\n                    this.reply_flag = (this.reply_flag !== true);\n                else\n                    this.replies[type].flag = (this.replies[type].flag !== true);\n            },\n            like() {\n                this.$message.info('暂不支持');\n            },\n            remove(cid) {\n                let url = 'http://localhost:8088/blog/removeComment?uid=' + sessionStorage.getItem(\"id\")\n                 + '&cid=' + cid\n                 + '&type=' + sessionStorage.getItem(\"type\");\n\n                axios.post(url, {\n                    headers: {\n                        token: sessionStorage.getItem(\"token\")\n                    }\n                }).then(res => {\n                    if (res.data === true) {\n                        this.$message.success('删除评论成功！');\n                        this.$emit('change');\n                    }\n                    else\n                        this.$message.error('没有权限删除！');\n                }).catch(err =>{\n                    console.log(err);\n                });\n            },\n            showMore() {\n                if (this.show_flag === 1)\n                    this.show_flag = 2;\n                else if (this.show_flag === 2)\n                    this.show_flag = 1;\n            },\n            visit(uid) {\n                this.$router.push({\n                    path: '/visit',\n                    query: {\n                        id: uid\n                    }\n                })\n            }\n        }\n    }\n</script>\n\n<style scoped>\n    .avatar {\n        float: left;\n        width: 8%;\n    }\n\n    .content {\n        width: 80%;\n        float: left;\n        margin-left: 5%;\n        color: black;\n    }\n\n    .down {\n        float: right;\n        width: 10%;\n    }\n\n    .comava {\n        float: left;\n        margin-left: 3%;\n        margin-bottom: 10%;\n    }\n\n    .con {\n        clear: both;\n    }\n\n    .con2 {\n        margin-bottom: 5%;\n     }\n\n    .icons {\n        clear: both;\n    }\n\n    .content-text1 {\n        text-align: left;\n        float: left;\n        color: dodgerblue;\n    }\n\n    .content-text2 {\n        text-align: left;\n        float: left;\n    }\n\n    .icon1 {\n        text-align: left;\n        float: left;\n        margin-top:1.5%;\n        color: darkgray;\n        font-size: 12px;\n    }\n\n    .icon2 {\n        float: right;\n        text-align: right;\n    }\n\n    .re-comment {\n        clear: both;\n        width: 100%;\n    }\n\n    .reply {\n        background-color: #eaeaec;\n        width: 100%;\n    }\n\n    .content-text4 {\n        width: 100%;\n        word-break:break-all;\n        float: left;\n        display: flex;\n    }\n\n    .more-button {\n        width: 100%;\n    }\n\n    .com {\n        background-color: #f2f2f5;\n    }\n\n    .content-text5 {\n        float: left;\n        margin-top: 13px;\n        color: darkgray;\n        font-size: 10px;\n    }\n</style>\n"],"sourceRoot":"src/components"}]}